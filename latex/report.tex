\documentclass[11pt]{article}

\usepackage[utf8]{inputenc}
\DeclareUnicodeCharacter{2212}{\textendash}
\usepackage[top=2cm, bottom=2cm]{geometry}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{gensymb}
\usepackage[skip=0.5cm]{parskip}
\usepackage[english]{babel}
\usepackage[citestyle=ieee]{biblatex}
\usepackage{cleveref}
\usepackage{csquotes}
\usepackage{amsfonts}
\usepackage{float}
\usepackage{soul}
\usepackage{tabularx}
\usepackage{pgf}

\renewcommand{\thesection}{\Alph{section}}
\renewcommand{\thesubsection}{(\roman{subsection})}
\title{my report}
\author{Liam Pribis 81326643}
\date{24 May 2021}
\begin{document}

\input{titlepage.tex}
\newpage
\section{Modulation type feasibility}
\section{Power spectral density of 4-PAM}\label{rect_psd_section}
The power spectral density of a pulse-shaped data sequence is given by the
energy spectral density of the pulse shape multiplied by power spectral density
of the impulse chain (data sequence). The power spectral density of the impulse
chain can be found be calculating the Fourier transform of the autocorrelation
of the impulse chain.
\begin{equation}
    S_y(f) = |P(f)|^2S_x(f) = |P(f)|^2 \mathcal{F} \{ R_x(\tau) \}
\end{equation}
$R_x(\tau)$ is a continuous autocorrelation, but due to the fact that the data
is comprised of delta functions, $R_x(\tau)$ will only be non-zero when these
delta functions line up, ie. when $\tau$ is an integer multiple of the sampling
period $T_s$. Because of this, $R_x(\tau)$ can be represented as a sum rather
than an integral.

$R_n$ represents the value of the autocorrelation at an integer sample offset of
$n$. $N$ represents the window size in units of samples ($N = \frac{T}{T_s}$).
\begin{equation}\label{rn}
    R_n = \lim_{N \to \infty}  \frac{1}{N} \sum_{k} a_k a_{k-n}
\end{equation}

Since the continuous time correlation is only non-zero at multiples of sample
period, it can be represented as an impulse chain (ie. sum of time-offset delta
functions), where the height of each delta function is given by the discreet
autocorrelation value at that offset.
\begin{equation}\label{autocorr}
    R_x(\tau) = \frac{1}{T_s} \sum_{n=-\infty}^{\infty} R_n \delta(\tau - nT_s)
\end{equation}

\subsection{Calculating $R_n$\label{calcrn}}
From \Cref{rn}, we can see that the discreet autocorrelation values are
dependent on two adjacent values of $x[n]$. No specific data sequence is given
in the question, so I will assume the input data is random. A table of all the
possible combinations of adjacent signals can be produced. Since this is 4-PAM,
the possible values for a single sample are $x[n] \in \{-3, -1, 1, 3\}$.
\begin{table}[H]
    \begin{center}
        \begin{tabular}{c|c c c c}
               & -3 & -1 & 1  & 3  \\
            \hline
            -3 & 9  & 3  & -3 & -9 \\
            -1 & 3  & 1  & -1 & -3 \\
            1  & -3 & -1 & 1  & 3  \\
            3  & -9 & -3 & 3  & 9
        \end{tabular}
    \end{center}
    \caption{Symbol combinations\label{combos}}
\end{table}
From \Cref{combos}, there are 16 possibilities for adjacent symbol
multiplication. $\pm\{1, 9\}$ occur twice each, while $\pm 3$ occur four
times each. Over a suffiently long dataset, the sum in \Cref{rn} will become an
average of all the combinations.
\begin{equation}
    \begin{gathered}
        \frac{1}{N} \sum_k a_k a_{k-n} = \frac{2}{16}(1) + \frac{2}{16}(-1) +
        \frac{2}{16}(9) + \frac{2}{16}(-9) + \frac{4}{16}(3) + \frac{4}{16}(-3)
        \\
        \frac{1}{N} \sum_k a_k a_{k-n} = 0
    \end{gathered}
\end{equation}

\subsection{Calculating $R_0$}
$R_0$ is the autocorrelation of the impulse chain at time of zero. The sum from
\Cref{rn} becomes
\begin{equation}
    \lim_{N \to \infty}  \frac{1}{N}\sum_k a_k^2
\end{equation}
Like in \Cref{calcrn}, it can be assumed that all possibilities of $\{-3, -1, 1,
    3\}$ are equally likelely, and the sum becomes the average.
\begin{equation}
    R_0 = \frac{1}{4}(-3)^2 + \frac{1}{4}(-1)^2 + \frac{1}{4}(1)^2 +
    \frac{1}{4}(3)^2 = 5
\end{equation}

\subsection{Calculating PSD}
From \Cref{autocorr}, since $R_n$ is zero for all $n\neq 0$:
\begin{equation}
    R_x(\tau) = R_0 \delta(\tau)
\end{equation}
\begin{equation}
    R_x(f) = \mathcal{F}\{\frac{5}{T_s} \delta(\tau)\} = \frac{5}{T_s} = S_x(f)
\end{equation}
\begin{equation}
    \begin{gathered}
        S_y(f) = |P(f)|^2S_x(f) = S_x(f) \int_{-\infty}^{\infty} rect(T_s)
        \,dt\\
        S_y(f) = \frac{5}{T_s}T_s = \boldsymbol 5
    \end{gathered}
\end{equation}


\section{Design of pulse shape}
A raised cosine filter is used for pulse shaping. Choose $B_T = 750KHz$ and
$\alpha = 1$ so that the filter produces maximum power transfer while staying
within the bandwidth limit.
\begin{figure}[H]
    \centering
    \scalebox{0.7}{\input{plots/rcos_psd.pgf}}
    \caption{Power spectral density of raised cosine filter\label{psdgraph}}
\end{figure}
The PSD calculated in \Cref{rect_psd_section} (using a rect pulse shape) has a
flat frequency response across all frequencies. This is not possible to transmit
as it requires infinite energy. It also violates the 750KHz bandwidth limit. The
raised cosine pulse shape constrains the PSD to lie within the bandwith limits.

\section{Baseband transmission simulation}
\begin{figure}[H]
    \centering
    \scalebox{0.7}{\input{plots/baseband_tx.pgf}}
    \caption{Baseband delta chain and pulse shaped output\label{bbtxgraph}}
\end{figure}

\section{Ideal channel eye diagram}
\begin{figure}[H]
    \centering
    \scalebox{0.7}{\input{plots/eye_diagram.pgf}}
    \caption{Eye diagram and sampling instant for a perfect channel}
\end{figure}

\section{AWGN effect}
An addition of additive white gaussian noise in the channel will cause the eye
to `close' more than in the perfect channel case.

To simulate this, the noise power needs to be calculated. The average energy per
symbol can be calculated as follows, where $E_p$ is the energy of a pulse.
\begin{equation}
    E_p = \int_{-\infty}^{\infty} |p(t)|^2 \,dt
\end{equation}
Given a value for $\frac{E_b}{N_0}$, the value for $N_0$ can be calculated as follows:
\begin{equation}
    N_0 = \left(\frac{E_b}{N_0} \right)^{-1} E_b
\end{equation}
For the filter selected in the baseband receiver simulation, the energy is
normalized such that $E_b = 1$. To generate noise to add to the channel, $N_0$
was used as the variance of a randomly sampled gaussian variable. The standard
deviation is given by $\sqrt{N_0}$. AWGN always has a mean $\mu = 0$.

\begin{figure}[H]
    \centering
    \scalebox{0.7}{\input{plots/awgn_eye_diagram.pgf}}
    \caption{Eye diagram with AWGN, $\frac{E_b}{N_0} = 10dB$}
\end{figure}

\section{4-PAM Detector}
To produce a 4-PAM thresholding detector, thresholds were chosen at $\{-2, 0,
    2\}$. These thresholds are in the midpoint between symbol signal levels. This
was chosen because AWGN causes symbol errors at the same rate irregardless of
which symbol is being transmitted. The detector samples at the ideal sampling
instant.


The detector was run with AWGN in the channel for a variety of $\frac{E_b}{N_0}$ values. Theoretical error rate was calculated using
\begin{equation}
    R_e = Q\left( \sqrt{2 \frac{E_b}{N_0}}\right)
\end{equation}

\begin{figure}[H]
    \centering
    \scalebox{0.7}{\input{plots/error_rate.pgf}}
    \caption{Bit error rate for simulated channel\label{error}}
\end{figure}

\begin{figure}[H]
    \centering
    \scalebox{0.7}{\input{plots/error_rate_log.pgf}}
    \caption{Bit error rate for simulated channel, log Y axis\label{errorlog}}
\end{figure}

As shown in \Cref{error}, the bit error rate is nearly zero for higher values of
$\frac{E_b}{N_0}$. This is very apparent in \Cref{errorlog}, where the error
rate is zero and therefor undefined/$-\infty$ on a log scale. The SNR of these
data points is high enough that not a single bit error occurs in the 10000
simulated bits. In order to predict the BER for these values of
$\frac{E_b}{N_0}$, a much longer bit stream would need to be simulated to
trigger enough bit errors to get a good statistical sample.

\section{ISI and Equalization}
\end{document}